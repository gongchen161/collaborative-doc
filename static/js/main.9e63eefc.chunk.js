(this["webpackJsonpcollaborative-doc"]=this["webpackJsonpcollaborative-doc"]||[]).push([[0],{134:function(e,t,n){},279:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(17),s=n.n(r),i=n(34),o=n(20),l=n(100),d=n.n(l),u=(n(133),n(134),n(71));try{u.a.apps.length||(console.log("initializing firebase"),u.a.initializeApp({apiKey:"AIzaSyAMVQX5KUs7J-GGEKOItKkeLT8J0WS0C6Y",authDomain:"collaborative-doc.firebaseapp.com",projectId:"collaborative-doc",storageBucket:"collaborative-doc.appspot.com",messagingSenderId:"493522432245",appId:"1:493522432245:web:0ab116816f5ba3d74fd5bc"}))}catch(le){console.log("error initializing firebase",le)}var j=u.a,b=u.a.auth(),p=n(326),h=n(318),O=n(102),f=n.n(O),x=n(5),m=c.a.createContext();function g(){return Object(a.useContext)(m)}function v(e){var t=e.children,n=Object(a.useState)(),c=Object(i.a)(n,2),r=c[0],s=c[1],o=Object(a.useState)(!1),l=Object(i.a)(o,2),d=l[0],u=l[1],j=Object(a.useState)(""),p=Object(i.a)(j,2),h={user:r,openSnackbar:d,setOpenSnackbar:u,message:p[0],setMessage:p[1]};return Object(a.useEffect)((function(){return b.onAuthStateChanged((function(e){s(e)}))}),[]),Object(x.jsx)(m.Provider,{value:h,children:t})}var w=n(39),k=n.n(w),y=n(50),I=n(311),S=n(313),C=n(315),E=n(140),R=n(316),W=n(101),A=n.n(W),N=n(317),D=n(43),P=n.n(D),T=n(329),z=n(26),M=n(136),q=n.n(M),B=n(86),G=n.n(B),K=Object(I.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function L(){var e=K(),t=Object(o.g)(),n=g(),a=n.openSnackbar,c=n.setOpenSnackbar,r=n.message,s=n.setMessage,i=n.user,l=function(){var e=Object(y.a)(k.a.mark((function e(n){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=G()(),e.prev=1,j.database().ref("testdb1").child("/".concat(i.uid,"-user")).push({docId:a,title:""}),e.next=10;break;case 5:return e.prev=5,e.t0=e.catch(1),c(!0),s("Error on creating a new document"),e.abrupt("return");case 10:t.push("/doc/".concat(a));case 11:case"end":return e.stop()}}),e,null,[[1,5]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)(S.a,{position:"static",children:[Object(x.jsx)(T.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:a,message:r,autoHideDuration:3e3,onClose:function(){c(!1),s("")}}),Object(x.jsxs)(C.a,{children:[Object(x.jsx)(R.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",children:Object(x.jsx)(A.a,{})}),Object(x.jsx)(E.a,{variant:"h6",className:e.title,children:"Collaborative Doc"}),!i&&Object(x.jsxs)(N.a,{component:z.b,to:"/login",color:"inherit",children:[" ",Object(x.jsx)(P.a,{})," "]}),i&&Object(x.jsxs)(N.a,{onClick:l,color:"inherit",children:[" ",Object(x.jsx)(q.a,{})," "]})]})]})}function J(e){var t=e.sessionId,n=Object(a.useRef)(),c=Object(a.useState)(""),r=Object(i.a)(c,2),s=(r[0],r[1],Object(a.useState)("")),l=Object(i.a)(s,2),u=l[0],b=l[1],O=Object(o.h)().docId,m=Object(a.createRef)(),v=Object(a.useState)(!1),w=Object(i.a)(v,2),k=w[0],y=w[1],I=g().user,S=Object(o.g)();Object(a.useEffect)((function(){I||S.push("/login")}),[]),Object(a.useEffect)((function(){try{console.log("loading changes from firebase"),j.database().ref("testdb1").child("/".concat(O,"-content")).on("child_added",(function(e){var a=e.val();n&&a.sessionId!==t&&n.current.getEditor().updateContents(a.delta)})),j.database().ref("testdb1").child("/".concat(O,"-title")).limitToLast(1).on("child_added",(function(e){var n=e.val();n.sessionId!==t&&b(n.title)}))}catch(le){console.log("error loading from firebse",le)}}),[]);var C=function(e){j.database().ref("testdb1").child("/".concat(O,"-title")).push({sessionId:t,title:e})};return Object(x.jsxs)("div",{children:[Object(x.jsx)(L,{}),Object(x.jsx)(p.a,{id:"standard-full-width",placeholder:"   Document Title",fullWidth:!0,value:u,margin:"normal",InputLabelProps:{shrink:!0},inputRef:m,disabled:k,readOnly:!0,autoFocus:!0,onChange:function(e){b(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(m.current.blur(),y(!0),C(m.current.value))},onClick:function(){y(!1)},onFocus:function(){y(!1),console.log(22)},onBlur:function(){y(!0),console.log(333),C(m.current.value)},InputProps:{startAdornment:Object(x.jsx)(h.a,{position:"start",children:Object(x.jsx)(f.a,{})})}}),Object(x.jsx)(d.a,{theme:"snow",onChange:function(e,n,a,c){"user"===a&&j.database().ref("testdb1").child("/".concat(O,"-content")).push({sessionId:t,delta:n})},ref:n})]})}var U=n(330),V=n(320),_=n(322),F=n(321),H=n(319),Q=Object(I.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},icon:{margin:e.spacing(1),backgroundColor:e.palette.primary.dark},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));function X(){var e=Q(),t=Object(a.useRef)(),n=Object(a.useRef)(),c=Object(a.useRef)(),r=g(),s=r.setOpenSnackbar,i=r.setMessage,l=r.user,d=Object(o.g)();Object(a.useEffect)((function(){l||d.push("/home")}),[]);var u=function(){var e=Object(y.a)(k.a.mark((function e(a){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),n.current.value===c.current.value){e.next=5;break}return i("password does not match"),s(!0),e.abrupt("return");case 5:return e.prev=5,e.next=8,b.createUserWithEmailAndPassword(t.current.value,n.current.value);case 8:e.next=15;break;case 10:e.prev=10,e.t0=e.catch(5),console.log(e.t0),i(e.t0.message),s(!0);case 15:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)("div",{children:[Object(x.jsx)(L,{}),Object(x.jsxs)(H.a,{component:"main",maxWidth:"xs",children:[Object(x.jsx)(V.a,{}),Object(x.jsxs)("div",{className:e.paper,children:[Object(x.jsx)(U.a,{className:e.icon,children:Object(x.jsx)(P.a,{})}),Object(x.jsx)(E.a,{component:"h1",variant:"h5",children:"Sign up"}),Object(x.jsxs)("form",{className:e.form,noValidate:!0,children:[Object(x.jsxs)(F.a,{container:!0,spacing:2,children:[Object(x.jsx)(F.a,{item:!0,xs:12,children:Object(x.jsx)(p.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",inputRef:t})}),Object(x.jsx)(F.a,{item:!0,xs:12,children:Object(x.jsx)(p.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",inputRef:n})}),Object(x.jsx)(F.a,{item:!0,xs:12,children:Object(x.jsx)(p.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password2",label:"Confirm Password",type:"password",id:"password2",inputRef:c})})]}),Object(x.jsx)(N.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,onClick:u,children:"Sign Up"}),Object(x.jsx)(F.a,{container:!0,justifyContent:"flex-end",children:Object(x.jsx)(F.a,{item:!0,children:Object(x.jsx)(_.a,{href:"#/login",variant:"body2",children:"Already have an account? Sign in"})})})]})]})]})]})}var Y=Object(I.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},icon:{margin:e.spacing(1),backgroundColor:e.palette.primary.dark},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));function Z(){var e=Y(),t=Object(a.useRef)(),n=Object(a.useRef)(),c=Object(o.g)(),r=g(),s=r.setOpenSnackbar,i=r.setMessage,l=r.user;Object(a.useEffect)((function(){l||c.push("/login")}),[]);var d=function(){var e=Object(y.a)(k.a.mark((function e(a){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,b.signInWithEmailAndPassword(t.current.value,n.current.value);case 4:c.push("/home"),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),i(e.t0.message),s(!0);case 12:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsxs)("div",{children:[Object(x.jsx)(L,{}),Object(x.jsxs)(H.a,{component:"main",maxWidth:"xs",children:[Object(x.jsx)(V.a,{}),Object(x.jsxs)("div",{className:e.paper,children:[Object(x.jsx)(U.a,{className:e.icon,children:Object(x.jsx)(P.a,{})}),Object(x.jsx)(E.a,{component:"h1",variant:"h5",children:"Login"}),Object(x.jsxs)("form",{className:e.form,noValidate:!0,children:[Object(x.jsxs)(F.a,{container:!0,spacing:2,children:[Object(x.jsx)(F.a,{item:!0,xs:12,children:Object(x.jsx)(p.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",inputRef:t})}),Object(x.jsx)(F.a,{item:!0,xs:12,children:Object(x.jsx)(p.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",inputRef:n})})]}),Object(x.jsx)(N.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,onClick:d,children:"Log In"}),Object(x.jsx)(F.a,{container:!0,justifyContent:"flex-end",children:Object(x.jsx)(F.a,{item:!0,children:Object(x.jsx)(_.a,{href:"#/signup",variant:"body2",children:"Don't have an account? Sign up"})})})]})]})]})]})}var $=n(106),ee=n(327),te=n(137),ne=n.n(te),ae=n(323),ce=n(325),re=n(324),se=Object(I.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"left",verticalAlign:"middle",color:e.palette.text.secondary,fontSize:"30px"}}}));var ie=function(){var e=g().user,t=se(),n=Object(o.g)(),c=Object(a.useState)([]),r=Object(i.a)(c,2),s=r[0],l=r[1];return Object(a.useEffect)((function(){e?(j.database().ref("testdb1").child("/".concat(e.uid,"-user")).on("child_added",(function(e){var t=e.val();t&&l((function(e){return[].concat(Object($.a)(e),[t])}))})),console.log(s)):n.push("/login")}),[]),console.log("home page rendering"),Object(x.jsxs)("div",{children:[Object(x.jsx)(L,{}),Object(x.jsx)(ee.a,{m:2,pt:3,children:Object(x.jsx)(F.a,{container:!0,spacing:3,children:Object($.a)(s).map((function(e,n){return Object(x.jsx)(F.a,{item:!0,xs:12,children:Object(x.jsx)(ae.a,{className:t.root,children:Object(x.jsx)(re.a,{children:Object(x.jsxs)(ce.a,{component:z.b,to:"/doc/".concat(e.docId),className:t.paper,linkto:!0,children:[" ",Object(x.jsx)(ne.a,{})," ",e.docId," ",e.title," "]})})})},e.docId)}))})})]})};var oe=function(){var e=G()();return Object(x.jsx)(v,{children:Object(x.jsx)(z.a,{children:Object(x.jsxs)(o.d,{children:[Object(x.jsx)(o.b,{exact:!0,path:"/",children:Object(x.jsx)(o.a,{to:"/home"})}),Object(x.jsx)(o.b,{exact:!0,path:"/signup",children:Object(x.jsx)(X,{})}),Object(x.jsx)(o.b,{exact:!0,path:"/login",children:Object(x.jsx)(Z,{})}),Object(x.jsx)(o.b,{exact:!0,path:"/home",children:Object(x.jsx)(ie,{})}),Object(x.jsxs)(o.b,{path:"/doc/:docId",children:[Object(x.jsx)(J,{sessionId:e}),Object(x.jsx)("div",{children:"v1.2"})]})]})})})};s.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(oe,{})}),document.getElementById("root"))}},[[279,1,2]]]);
//# sourceMappingURL=main.9e63eefc.chunk.js.map