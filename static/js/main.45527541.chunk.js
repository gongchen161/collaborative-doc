(this["webpackJsonpcollaborative-doc"]=this["webpackJsonpcollaborative-doc"]||[]).push([[0],{146:function(e,t,a){},300:function(e,t){},304:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(16),i=a.n(r),s=a(23),o=a(21),l=a(113),d=a.n(l),j=(a(145),a(146),a(78));try{j.a.apps.length||(console.log("initializing firebase"),j.a.initializeApp({apiKey:"AIzaSyAMVQX5KUs7J-GGEKOItKkeLT8J0WS0C6Y",authDomain:"collaborative-doc.firebaseapp.com",projectId:"collaborative-doc",storageBucket:"collaborative-doc.appspot.com",messagingSenderId:"493522432245",appId:"1:493522432245:web:0ab116816f5ba3d74fd5bc"}))}catch(Ae){console.log("error initializing firebase",Ae)}var u=j.a,b=j.a.auth(),h=a(367),p=a(356),O=a(115),m=a.n(O),f=a(59),x=a.n(f),g=a(4),v=c.a.createContext();function y(){return Object(n.useContext)(v)}function w(e){var t=e.children,a=Object(n.useState)(),c=Object(s.a)(a,2),r=c[0],i=c[1],o=Object(n.useState)(!1),l=Object(s.a)(o,2),d=l[0],j=l[1],u=Object(n.useState)(""),h=Object(s.a)(u,2);var p={user:r,openSnackbar:d,setOpenSnackbar:j,message:h[0],setMessage:h[1],timeout:function(e){return new Promise((function(t){return setTimeout(t,e)}))}};return Object(n.useEffect)((function(){return b.onAuthStateChanged((function(e){i(e)}))}),[]),Object(g.jsx)(v.Provider,{value:p,children:t})}var k=a(28),S=a.n(k),C=a(46),I=a(343),N=a(345),D=a(348),E=a(98),T=a(349),A=a(114),R=a.n(A),W=a(350),B=a(41),M=a.n(B),P=a(370),z=a(25),L=a(153),G=a.n(L),q=a(152),K=a.n(q),U=a(156),J=a(374),V=a(154),F=a.n(V),_=a(371),H=a(354),Q=a(352),X=a(353),Y=a(351),Z=a(55),$=a.n(Z),ee=a(355),te=Object(I.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function ae(e){var t=e.inDoc,a=e.docId,c=te(),r=Object(o.g)(),i=Object(n.useState)(null),l=Object(s.a)(i,2),d=l[0],j=l[1],p=Object(n.useState)(!1),O=Object(s.a)(p,2),m=O[0],f=O[1],v=y(),w=v.openSnackbar,k=v.setOpenSnackbar,I=v.message,A=v.setMessage,B=v.user,L=v.timeout,q=Object(n.useRef)(),V=Object(n.useState)(!1),Z=Object(s.a)(V,2),ae=Z[0],ne=Z[1],ce=function(){var e=Object(C.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(null),e.prev=1,e.next=4,b.signOut();case 4:r.push("/login"),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),A(e.t0.message),k(!0);case 12:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=Object(C.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j(null),r.push("/profile");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){f(!1)},se=function(){var e=Object(C.a)(S.a.mark((function e(t){var a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x()(),e.prev=1,ne(!0),console.log("++++++ creating doc to firebase"),e.next=6,u.database().ref("testdb1").child("/".concat($()(B.email),"-user")).push({docId:a});case 6:return e.next=8,u.database().ref("testdb1").child("/".concat(a,"-misc")).update({createdBy:B.email,createdTime:(new Date).getTime(),title:"Untitled"});case 8:e.next=18;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,L(1500);case 14:return ne(!1),k(!0),A("Error on creating a new document"),e.abrupt("return");case 18:return e.next=20,L(1500);case 20:ne(!1),r.push("/doc/".concat(a));case 22:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsxs)(N.a,{position:"static",color:"primary",children:[Object(g.jsx)(P.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:w,message:I,autoHideDuration:3e3,onClose:function(){k(!1),A("")}}),Object(g.jsxs)(D.a,{children:[Object(g.jsx)(T.a,{edge:"start",className:c.menuButton,color:"inherit","aria-label":"menu",children:Object(g.jsxs)(W.a,{component:z.b,to:"/home",color:"inherit",children:[" ",Object(g.jsx)(K.a,{})]})}),Object(g.jsx)(E.a,{variant:"h6",className:c.title,children:"Collaborative Doc"}),!B&&Object(g.jsxs)(W.a,{component:z.b,to:"/login",color:"inherit",children:[" ",Object(g.jsx)(M.a,{})," Log In"]}),B&&!t&&Object(g.jsxs)(W.a,{onClick:se,color:"inherit",children:[" ",Object(g.jsx)(G.a,{}),"   Create A New Doc"]}),B&&t&&Object(g.jsxs)(W.a,{onClick:function(){f(!0)},color:"inherit",children:[Object(g.jsx)(F.a,{}),"   Share Doc"]}),B&&Object(g.jsxs)("div",{children:[Object(g.jsx)(W.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){j(e.currentTarget)},color:"inherit",children:Object(g.jsx)(R.a,{color:"inherit"})}),Object(g.jsxs)(U.a,{id:"simple-menu",anchorEl:d,keepMounted:!0,open:Boolean(d),onClose:function(){j(null)},children:[Object(g.jsx)(J.a,{onClick:re,children:"Profile"}),Object(g.jsx)(J.a,{onClick:ce,children:"Logout"})]})]}),Object(g.jsxs)(_.a,{open:m,onClose:ie,"aria-labelledby":"form-dialog-title",children:[Object(g.jsx)(Y.a,{id:"form-dialog-title",children:"Share Doc"}),Object(g.jsxs)(Q.a,{children:[Object(g.jsx)(X.a,{children:"To share, please enter the email"}),Object(g.jsx)(h.a,{autoFocus:!0,margin:"dense",id:"name",label:"Email Address",type:"email",fullWidth:!0,inputRef:q})]}),Object(g.jsxs)(H.a,{children:[Object(g.jsx)(W.a,{onClick:ie,color:"primary",children:"Cancel"}),Object(g.jsx)(W.a,{onClick:function(){try{console.log("++++++ processShareDoc from firebase"),u.database().ref("testdb1").child("/".concat($()(q.current.value),"-user")).push({docId:a})}catch(Ae){k(!0),A(Ae.message),console.log("error loading from firebse",Ae)}f(!1)},color:"primary",children:"Share"})]})]}),Object(g.jsxs)(_.a,{open:ae,onClose:function(){},"aria-labelledby":"form-dialog-title",children:[Object(g.jsx)(Y.a,{id:"form-dialog-title",children:"Creating Doc"}),Object(g.jsx)(Q.a,{children:Object(g.jsxs)(X.a,{className:"center",children:["Creating New Doc... Please wait...",Object(g.jsx)(ee.a,{})]})}),Object(g.jsx)(H.a,{})]})]})]})}var ne=a(357);function ce(){var e=Object(n.useRef)(),t=Object(n.useState)(""),a=Object(s.a)(t,2),c=(a[0],a[1],Object(n.useState)("Untitled")),r=Object(s.a)(c,2),i=r[0],l=r[1],j=Object(o.h)().docId,b=Object(n.useState)(x()()),O=Object(s.a)(b,2),f=O[0],v=(O[1],Object(n.createRef)()),w=Object(n.useState)(!1),k=Object(s.a)(w,2),S=k[0],C=k[1],I=y(),N=I.user,D=I.setOpenSnackbar,E=I.setMessage,T=(I.timeout,Object(o.g)()),A=Object(n.useState)(!1),R=Object(s.a)(A,2),W=R[0],B=R[1];Object(n.useEffect)((function(){N||T.push("/login")}),[]),Object(n.useEffect)((function(){B(!0);try{u.database().ref("testdb1").child("/".concat(j,"-content")).on("child_added",(function(t){console.log("------ fetching content from firebase");var a=t.val();e&&e.current&&a.sessionId!==f&&e.current.getEditor().updateContents(a.delta)})),u.database().ref("testdb1").child("/".concat(j,"-misc")).on("value",(function(e){console.log("------ fetching title from firebase");var t=e.val();l(t.title)}))}catch(Ae){console.log("error loading from firebse",Ae)}setTimeout((function(){return B(!1)}),1e3)}),[]);var M=function(e){e&&0!==e.trim().length&&(console.log("++++++ uploading title to firebase"),u.database().ref("testdb1").child("/".concat(j,"-misc")).update({title:e}))};return Object(g.jsxs)("div",{children:[Object(g.jsx)(ae,{inDoc:!0,docId:j}),Object(g.jsx)(h.a,{id:"standard-full-width",placeholder:"   Document Title",fullWidth:!0,value:i,margin:"normal",InputLabelProps:{shrink:!0},inputRef:v,disabled:S||W,readOnly:!0,onChange:function(e){if(0===e.target.value.trim().length)return D(!0),void E("Title cannot be empty");l(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(v.current.blur(),C(!0),M(v.current.value))},onClick:function(){C(!1)},onFocus:function(){C(!1),console.log(22)},onBlur:function(){C(!0),console.log(333),M(v.current.value)},InputProps:{startAdornment:Object(g.jsx)(p.a,{position:"start",children:Object(g.jsx)(m.a,{})})}}),W&&Object(g.jsx)("div",{children:Object(g.jsx)(ne.a,{color:"primary",size:80,thickness:10})}),Object(g.jsx)(d.a,{theme:"snow",onChange:function(e,t,a,n){"user"===a&&(console.log("++++++ uploading delta to firebase"),u.database().ref("testdb1").child("/".concat(j,"-content")).push({sessionId:f,delta:t}))},readOnly:W,ref:e})]})}var re=a(372),ie=a(359),se=a(361),oe=a(360),le=a(358),de=Object(I.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},icon:{margin:e.spacing(1),backgroundColor:e.palette.primary.dark},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));function je(){var e=de(),t=Object(n.useRef)(),a=Object(n.useRef)(),c=Object(n.useRef)(),r=y(),i=r.setOpenSnackbar,s=r.setMessage,l=r.user,d=Object(o.g)();Object(n.useEffect)((function(){l&&d.push("/home")}),[]);var j=function(){var e=Object(C.a)(S.a.mark((function e(n){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),a.current.value===c.current.value){e.next=5;break}return s("password does not match"),i(!0),e.abrupt("return");case 5:return e.prev=5,e.next=8,b.createUserWithEmailAndPassword(t.current.value,a.current.value);case 8:d.push("/home"),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(5),console.log(e.t0),s(e.t0.message),i(!0);case 16:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{children:[Object(g.jsx)(ae,{}),Object(g.jsxs)(le.a,{component:"main",maxWidth:"xs",children:[Object(g.jsx)(ie.a,{}),Object(g.jsxs)("div",{className:e.paper,children:[Object(g.jsx)(re.a,{className:e.icon,children:Object(g.jsx)(M.a,{})}),Object(g.jsx)(E.a,{component:"h1",variant:"h5",children:"Sign up"}),Object(g.jsxs)("form",{className:e.form,noValidate:!0,children:[Object(g.jsxs)(oe.a,{container:!0,spacing:2,children:[Object(g.jsx)(oe.a,{item:!0,xs:12,children:Object(g.jsx)(h.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",inputRef:t})}),Object(g.jsx)(oe.a,{item:!0,xs:12,children:Object(g.jsx)(h.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",inputRef:a})}),Object(g.jsx)(oe.a,{item:!0,xs:12,children:Object(g.jsx)(h.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password2",label:"Confirm Password",type:"password",id:"password2",inputRef:c})})]}),Object(g.jsx)(W.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,onClick:j,children:"Sign Up"}),Object(g.jsx)(oe.a,{container:!0,justifyContent:"flex-end",children:Object(g.jsx)(oe.a,{item:!0,children:Object(g.jsx)(se.a,{href:"#/login",variant:"body2",children:"Already have an account? Sign in"})})})]})]})]})]})}var ue=Object(I.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},icon:{margin:e.spacing(1),backgroundColor:e.palette.primary.dark},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));function be(){var e=ue(),t=Object(n.useRef)(),a=Object(n.useRef)(),c=Object(o.g)(),r=y(),i=r.setOpenSnackbar,s=r.setMessage,l=r.user;Object(n.useEffect)((function(){l&&c.push("/home")}),[]);var d=function(){var e=Object(C.a)(S.a.mark((function e(n){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,b.signInWithEmailAndPassword(t.current.value,a.current.value);case 4:c.push("/home"),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),s(e.t0.message),i(!0);case 12:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{children:[Object(g.jsx)(ae,{}),Object(g.jsxs)(le.a,{component:"main",maxWidth:"xs",children:[Object(g.jsx)(ie.a,{}),Object(g.jsxs)("div",{className:e.paper,children:[Object(g.jsx)(re.a,{className:e.icon,children:Object(g.jsx)(M.a,{})}),Object(g.jsx)(E.a,{component:"h1",variant:"h5",children:"Login"}),Object(g.jsxs)("form",{className:e.form,noValidate:!0,children:[Object(g.jsxs)(oe.a,{container:!0,spacing:2,children:[Object(g.jsx)(oe.a,{item:!0,xs:12,children:Object(g.jsx)(h.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",inputRef:t})}),Object(g.jsx)(oe.a,{item:!0,xs:12,children:Object(g.jsx)(h.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",inputRef:a})})]}),Object(g.jsx)(W.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,onClick:d,children:"Log In"}),Object(g.jsx)(oe.a,{container:!0,justifyContent:"flex-end",children:Object(g.jsx)(oe.a,{item:!0,children:Object(g.jsx)(se.a,{href:"#/signup",variant:"body2",children:"Don't have an account? Sign up"})})})]})]})]})]})}var he=a(119),pe=a(97),Oe=a(368),me=a(96),fe=a.n(me),xe=a(363),ge=a(365),ve=a(362),ye=a(364),we=Object(I.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"left",verticalAlign:"middle",color:e.palette.text.secondary,fontSize:"30px"},icon:{color:"rgb(48, 128, 188)"}}}));var ke=function(){var e=y(),t=e.user,a=(e.timeout,we()),c=Object(o.g)(),r=Object(n.useState)([]),i=Object(s.a)(r,2),l=i[0],d=i[1],j=Object(n.useState)(!1),b=Object(s.a)(j,2),h=b[0],p=b[1];return Object(n.useEffect)((function(){t?(console.log("start loading"),p(!0),console.log("done loading"),u.database().ref("testdb1").child("/".concat($()(t.email),"-user")).on("child_added",(function(e){console.log("------ fetching user from firebase");var t=e.val();t&&u.database().ref("testdb1").child("/".concat(t.docId,"-misc")).on("value",(function(e){console.log("------ fetching user-title from firebase");var a=e.val();l.some((function(e){return e.docId===t.docId}))||d((function(e){return[].concat(Object(pe.a)(e),[Object(he.a)(Object(he.a)({},a),{},{docId:t.docId})]).sort((function(e,t){return e.createdTime<t.createdTime}))}))}))})),console.log(l),setTimeout((function(){return p(!1)}),1e3)):c.push("/login")}),[]),console.log("home page rendering"),Object(g.jsxs)("div",{children:[Object(g.jsx)(ae,{}),h&&Object(g.jsxs)("div",{className:"center",children:[Object(g.jsx)(ee.a,{color:"primary",size:60}),Object(g.jsx)(E.a,{variant:"h5",children:"Loading Docs..."})]}),!h&&Object(g.jsxs)(Oe.a,{m:2,pt:3,children:[Object(g.jsxs)(Oe.a,{m:2,pt:3,children:[Object(g.jsx)(E.a,{className:"center",variant:"h4",children:" My Docs"}),Object(g.jsx)(ve.a,{variant:"middle"})]}),Object(g.jsx)(oe.a,{container:!0,spacing:3,children:0!==l.length&&l.some((function(e){return e.createdBy===t.email}))?Object(pe.a)(l).map((function(e,n){return e.createdBy===t.email&&Object(g.jsx)(oe.a,{item:!0,xs:4,children:Object(g.jsx)(xe.a,{className:a.root,children:Object(g.jsx)(ye.a,{component:z.b,to:"/doc/".concat(e.docId),children:Object(g.jsxs)(ge.a,{className:a.paper,children:[Object(g.jsx)(fe.a,{color:"primary"}),Object(g.jsxs)(E.a,{variant:"h5",children:[" ",e.title]}),Object(g.jsxs)(E.a,{variant:"body1",children:[" "," "]}),Object(g.jsxs)(E.a,{variant:"caption",children:[" ",new Date(e.createdTime).toString("MMM dd hh:mm")]})]})})})},e.docId)})):Object(g.jsx)(E.a,{variant:"h5",children:"No docs found"})}),Object(g.jsxs)(Oe.a,{m:2,pt:3,children:[Object(g.jsx)(E.a,{className:"center",variant:"h4",children:" Docs shared to me"}),Object(g.jsx)(ve.a,{variant:"middle"})]}),Object(g.jsx)(oe.a,{container:!0,spacing:3,children:0!==l.length&&l.some((function(e){return e.createdBy!==t.email}))?Object(pe.a)(l).map((function(e,n){return e.createdBy!==t.email&&Object(g.jsx)(oe.a,{item:!0,xs:4,children:Object(g.jsx)(xe.a,{className:a.root,children:Object(g.jsx)(ye.a,{component:z.b,to:"/doc/".concat(e.docId),children:Object(g.jsxs)(ge.a,{className:a.paper,children:[Object(g.jsx)(fe.a,{color:"primary"}),Object(g.jsxs)(E.a,{variant:"h5",children:[" ",e.title]}),Object(g.jsxs)(E.a,{variant:"body1",children:[" From: ",e.createdBy]}),Object(g.jsxs)(E.a,{variant:"caption",children:[" ",new Date(e.createdTime).toString()]})]})})})},e.docId)})):Object(g.jsx)(E.a,{variant:"h5",children:"No docs found"})})]})]})},Se=Object(I.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"left",verticalAlign:"middle",color:e.palette.text.secondary,fontSize:"30px"}}}));var Ce=function(){var e=y().user,t=(Se(),Object(o.g)()),a=Object(n.useState)([]),c=Object(s.a)(a,2);return c[0],c[1],Object(n.useEffect)((function(){e||t.push("/login")}),[]),Object(g.jsxs)("div",{children:[Object(g.jsx)(ae,{}),Object(g.jsxs)(xe.a,{className:"center",children:[Object(g.jsx)(M.a,{color:"primary",size:44,children:" "}),Object(g.jsxs)(E.a,{children:["Email: ",e.email]})]})]})};var Ie=function(){return $()("Test1"),Object(g.jsx)(w,{children:Object(g.jsx)(z.a,{children:Object(g.jsxs)(o.d,{children:[Object(g.jsx)(o.b,{exact:!0,path:"/",children:Object(g.jsx)(o.a,{to:"/home"})}),Object(g.jsx)(o.b,{exact:!0,path:"/signup",children:Object(g.jsx)(je,{})}),Object(g.jsx)(o.b,{exact:!0,path:"/login",children:Object(g.jsx)(be,{})}),Object(g.jsx)(o.b,{exact:!0,path:"/home",children:Object(g.jsx)(ke,{})}),Object(g.jsx)(o.b,{exact:!0,path:"/profile",children:Object(g.jsx)(Ce,{})}),Object(g.jsx)(o.b,{path:"/doc/:docId",children:Object(g.jsx)(ce,{})})]})})})},Ne=a(155),De=a(366),Ee="rgb(48, 128, 188)",Te=Object(Ne.a)({palette:{primary:{light:Ee,main:Ee,dark:Ee},secondary:{main:Ee}},typography:{useNextVariants:!0}});i.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(De.a,{theme:Te,children:Object(g.jsx)(Ie,{})})}),document.getElementById("root"))}},[[304,1,2]]]);
//# sourceMappingURL=main.45527541.chunk.js.map